<div class="profile-container">
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">

      <% if @posts.present? %>
        <div class="d-flex flex-column" style="gap: 24px; padding-top: 16px; padding-bottom: 32px;">
          <% @posts.each do |post| %>
            <% post_id = post['post_id'] || post['id'] %>
            <% author = post['author_username'] || post['username'] %>
            <div class="card" style="border-radius: 12px; border: 1px solid #dbdbdb;">

              <!-- Post Header -->
              <div class="card-header d-flex align-items-center" style="background: none; border-bottom: 1px solid #efefef; padding: 14px 16px;">
                <% if author.present? %>
                  <%= link_to fyp_user_page_path(username: author), class: "d-flex align-items-center text-decoration-none text-dark" do %>
                    <div class="profile-picture" style="width: 32px; height: 32px; font-size: 14px; margin-right: 12px;">
                      <%= author.first.upcase %>
                    </div>
                    <strong><%= author %></strong>
                  <% end %>
                <% end %>
              </div>

              <!-- Post Body -->
              <%= link_to (post_id.present? ? fyp_post_path(post_id) : "#"), style: "text-decoration: none; color: inherit;" do %>
                <div class="card-body" style="padding: 16px;">
                  <h5 style="font-weight: 700; margin-bottom: 8px;"><%= post['title'] || 'Untitled' %></h5>
                  <% if post['content'].present? %>
                    <p style="margin-bottom: 12px; white-space: pre-wrap; color: #262626;"><%= truncate(post['content'], length: 200) %></p>
                  <% end %>
                  <% if post['event_name_mention'].present? %>
                    <span class="badge" style="background-color: #e8f4f8; color: #1a7fa0; font-size: 0.8rem;">
                      <i class="bi bi-calendar-event me-1"></i><%= post['event_name_mention'] %>
                    </span>
                  <% end %>
                </div>
              <% end %>

              <!-- Footer -->
              <% if post['created_at'].present? %>
                <div style="padding: 8px 16px; border-top: 1px solid #efefef;">
                  <span class="text-muted" style="font-size: 0.75rem;">
                    <%= Time.parse(post['created_at']).strftime('%B %d, %Y') rescue post['created_at'] %>
                  </span>
                </div>
              <% end %>

            </div>
          <% end %>
        </div>
      <% else %>
        <div class="text-center text-muted py-5" style="margin-top: 80px;">
          <i class="bi bi-people" style="font-size: 3rem; color: #dbdbdb;"></i>
          <p class="mt-3" style="font-size: 1.1rem;">Your feed is empty.</p>
          <p class="text-muted">Follow people to see their posts here.</p>
          <%= link_to "Find people", fyp_search_path, class: "btn btn-outline-secondary btn-sm mt-2" %>
        </div>
      <% end %>

    </div>
  </div>
</div>
